#!/bin/bash
set -eu

CPU=$1
MEM=$2
DISK=$3
MACS="$4"
SERVICE_HOST="$5"
# Power management settings are optional and only used for real bare metal.
PM_IPS=( $6 )
PM_USERS=( $7 )
PM_PASSWORDS=( $8 )

count=0
for MAC in $MACS; do

    if [ -n "$PM_IPS" -a -n "$PM_USERS" -a -n "$PM_PASSWORDS" ]; then
        nova baremetal-node-create --pm_address=${ips[$count]} --pm_user=${users[$count]} --pm_password=${passwords[$count]} $NODES $CPU $MEM $DISK $MAC
    else
        nova baremetal-node-create $NODES $CPU $MEM $DISK $MAC
    fi

    count=$((count + 1))

done
date
echo "Nodes will be available in 60 seconds from now."
